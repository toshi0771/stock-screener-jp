# 株式スクリーニングWebアプリケーション - 更新履歴

**最終更新日**: 2025年10月24日 02:15  
**アーカイブファイル**: `stock_screener_final_20251024_021523.tar.gz`

---

## 2025年10月24日 - v2.1 UI改善版

### UI修正

#### 1. 配色変更
- **背景色**: 濃紺（#001f3f）に変更
- **グラディエーション**: 削除（シンプルな単色背景）
- **スクリーニング実行ボタン**: 黄色（#FFD700）に変更
  - より目立つデザイン
  - ホバー時のエフェクト強化
  - 大文字表記（UPPERCASE）
  - 文字間隔を広げて視認性向上

#### 2. アクティブ状態の改善
- **選択中のカード**: 緑色（#4CAF50）に変更
- **視認性**: より明確な選択状態

#### 3. 銘柄コード表示
- **5桁→4桁変換**: 末尾の0を自動削除
- **例**: `13010` → `1301`（東京建物）
- **適用箇所**: 
  - スクリーニング結果一覧
  - 過去データ履歴

#### 4. 過去データ表示の改善
- **銘柄名の列挙**: 具体的な銘柄名を表示（最大10銘柄）
- **ボックス表示**: 各銘柄を見やすくボックス化
- **アクセントライン**: 左に緑色のラインを追加
- **レイアウト**: 適切な余白とフォントサイズ
- **表形式**: 日付ごとに整理された表示

### バックエンド改善

#### 過去データAPI拡張
- **screening_results**テーブルから`id`も取得
- **detected_stocks**テーブルから銘柄情報を取得
- **銘柄名フォーマット**: `会社名(コード)`形式で返却
- **制限**: 各手法につき最大10銘柄まで表示

---

## 2025年10月23日 - v2.0 Final

### 主要機能実装

#### 1. 新UI実装
- 4つのボタンを横並び表示（スマホは2列グリッド）
- クリックでアクティブ状態に変化
- スクリーニング実行ボタン常時表示
- 過去データ用プルダウンメニュー（10日/30日/60日）
- レスポンシブデザイン対応

#### 2. jQuants API連携
- 全3,795銘柄対応（プライム1,616・スタンダード1,569・グロース610）
- 並列処理による高速スクリーニング（約2分で全銘柄処理）
- 有料版API対応

#### 3. Supabaseデータベース連携
- スクリーニング結果の永続保存
- 過去データ履歴管理
- リアルタイムデータ取得

#### 4. スクリーニング機能
- パーフェクトオーダー
- ボリンジャーバンド±3σ
- 52週新高値押し目

---

## ファイル構成

```
stock_screener_enhanced/
├── app.py                              # Flaskアプリケーション
├── daily_data_collection.py           # 日次データ収集スクリプト
├── .env                                # 環境変数設定
├── templates/
│   └── index_new.html                  # 新UI（v2.1）
├── data/
│   └── screening_history.json          # ローカル履歴データ
├── logs/
│   └── daily_collection_YYYYMMDD.log   # 実行ログ
├── Flaskアプリトラブル対処法.md         # トラブルシューティング
├── 完成報告書_20251023.md              # 完成報告書
└── 更新履歴_20251024.md                # 本ドキュメント
```

---

## 技術スタック

### フロントエンド
- HTML5 / CSS3
- Vanilla JavaScript
- レスポンシブデザイン

### バックエンド
- Python 3.11
- Flask
- Supabase
- aiohttp（非同期HTTP通信）

### データソース
- jQuants API（有料版）
- Supabase PostgreSQL

---

## 環境変数

`.env`ファイルに以下を設定:

```bash
SUPABASE_URL=https://asdvlrcwkbmwbosecoti.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
JQUANTS_REFRESH_TOKEN=eyJjdHkiOiJKV1QiLCJlbmMiOiJBMjU2R0NNIiwiYWxnIjoiUlNBLU9BRVAifQ...
```

---

## 使用方法

### Webアプリケーション起動

```bash
cd /home/ubuntu/stock_screener_enhanced
python3 app.py
```

### 日次データ収集

```bash
cd /home/ubuntu/stock_screener_enhanced
python3 daily_data_collection.py
```

---

## 今後の実装予定

### 短期（1-2週間）

1. **ロリポップサーバーへのデプロイ**
   - 本番環境への移行
   - ドメイン設定
   - SSL証明書設定

2. **検証期間**
   - 実データでの動作確認
   - パフォーマンス測定
   - バグ修正

3. **過去データCSVダウンロード機能**
   - エクスポート機能実装
   - フォーマット選択（CSV/Excel）
   - 期間指定ダウンロード

### 中期（1-2ヶ月）

4. **ユーザー登録機能**
   - 会員登録フォーム
   - ログイン/ログアウト
   - プロフィール管理

5. **Clerk認証統合**
   - ソーシャルログイン対応
   - メール認証
   - セキュリティ強化

6. **Stripe決済統合**
   - サブスクリプション管理
   - 料金プラン設定
   - 決済処理

### 長期（3ヶ月以降）

7. **AI推奨機能**
   - OpenAI API統合
   - 銘柄分析
   - 投資判断サポート

8. **アラート機能**
   - メール通知
   - LINE/Slack連携
   - カスタム条件設定

9. **チャート表示**
   - ローソク足チャート
   - 指標の可視化
   - インタラクティブグラフ

10. **バックテスト機能**
    - 過去データでの検証
    - 勝率・損益計算
    - レポート生成

---

## バージョン比較

| バージョン | リリース日 | 主な変更点 |
|-----------|-----------|-----------|
| v2.1 | 2025-10-24 | UI改善（黄色ボタン、過去データ表示改善） |
| v2.0 | 2025-10-23 | 新UI実装、jQuants API連携、Supabase連携 |
| v1.5 | 2025-10-22 | 並列処理版日次データ収集 |
| v1.0 | 2025-10-18 | 初期バージョン |

---

## 既知の問題

現時点で既知の問題はありません。

---

## サポート

詳細なトラブルシューティングは `Flaskアプリトラブル対処法.md` を参照してください。

---

**作成者**: Manus AI Agent  
**プロジェクト**: 株式スクリーニングWebアプリケーション  
**次回更新予定**: ロリポップデプロイ後

